extends ../layout/admin

block styles
    meta(name="csrf-token" content= csrfToken)

block contenido

    div.flex.flex-col.items-center.justify-center.min-h-screen.bg-gradient-to-b.from-blue-50.via-blue-100.to-blue-200
        div.p-2
            h1.text-5xl.font-semibold.text-gray-800= pagina
            h2.text-2xl.font-light.text-gray-600.mt-5 Maneja y administra tus propiedades
        nav.mt-8
            a(href="/propiedades/crear" class="text-white bg-gradient-to-r from-blue-500 via-blue-600 to-blue-700 hover:bg-gradient-to-br focus:ring-4 focus:outline-none focus:ring-blue-300 dark:focus:ring-blue-800 shadow-lg shadow-blue-500/50 dark:shadow-lg dark:shadow-blue-800/80 font-medium rounded-lg text-sm px-5 py-2.5 text-center")| + NUEVA PROPIEDAD


    .py-10
        //-pre= JSON.stringify(propiedades, undefined, 2)
        //-muestra una sola propiedad con la iteracion
        
    
        if propiedades.length
            div(class="flex gap-2")
                h1(class="text-gray-500 p-1") Propiedades publicadas: 
                p(class="text-bold p-1")= propiedades.length

            div(class="relative overflow-x-auto shadow-md sm:rounded-lg p-3")
                table(class="w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400")
                    thead(class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400")
                        tr
                            th(scope="col" class="px-6 py-3") Propiedad
                            th(scope="col" class="px-6 py-3") Imagen
                            th(scope="col" class="px-6 py-3") Categoria
                            th(scope="col" class="px-6 py-3") Precio
                            th(scope="col" class="px-6 py-3") Mensajes
                            th(scope="col" class="px-6 py-3") Acci√≥n
                    tbody
                        each propiedad in propiedades
                            tr(class="text-lg bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600")
                                th(scope="row" class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white")
                                    a( href=`/propiedad/${propiedad.id}`)= propiedad.titulo= propiedad.titulo
                                td(class="px-6 py-4 w-1/6")
                                    img(src=`uploads/${propiedad.imagen}`, alt=`Imagen propiedad ${propiedad.imagen}` class="w-full h-20 object-cover rounded-lg")  
                                td(class="px-6 py-4")= propiedad.categoria.nombre
                                td(class="px-6 py-4")= propiedad.precio
                                td(class="px-6 py-4 mr-1")
                                    a(href=`/mensajes/${propiedad.id}` class="text-lg text-gray-600")=`${propiedad.mensajes.length}`   
                                    i(class="fas fa-envelope text-blue-600 dark:text-blue-500")  
                                td(class="px-6 py-4 text-center")
                                    button( data-propiedad-id=`${propiedad.id}` type="button" class= `cambiar-estado w-full px-2 py-2 md:py-1 text-xs leading-5 font-semibold rounded cursor-pointer ${propiedad.publicado ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-red-800'}`)=  `${propiedad.publicado ? 'Publicado' : 'No Publicado'}` 
                                    a(href=`/propiedades/editar/${propiedad.id}` class="font-medium text-yellow-200 dark:text-yellow-300 hover:underline mx-2")
                                        i(class="fas fa-edit text-xl")
                                    form(action=`/propiedades/eliminar/${propiedad.id}` method="POST")
                                        input(type="hidden" name="_csrf" value=csrfToken)
                                        button(type="submit" class="text-red-600 dark:text-red-500 hover:underline mx-2 p-0 bg-transparent border-0")
                                            i(class="fas fa-trash-alt text-xl")


            div(class="bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6")
                div(class="flex-1 flex justify-between sm:hidden")
                    a(href=`/mis-propiedades?pagina=${paginaActual - 1}` class=`${paginaActual === "1" ? 'pointer-events-none' : ''} relative inline-flex items-center px-4 py-2 border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50`) Anterior
                    a(href=`/mis-propiedades?pagina=${paginaActual + 1}` class=`${paginaActual === paginas ? 'pointer-events-none' : ''} relative inline-flex items-center px-4 py-2 border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50`) Siguiente

                div(class="sm:flex-1 sm:flex sm:items-center sm:justify-between")
                    p(class="text-sm text-gray-700 gap-2") Mostrando
                        span(class="font-medium")  #{offset + 1} a
                        span(class="font-medium")  #{total < limite + offset ? total : limit + offset} de
                        span(class="font-medium")  #{total} resultados

                div(class="hidden sm:block")
                    nav(class="relative z-0 inline-flex rounded-md shadow-md")
                        - var n = 1
                        while n <= paginas
                            a(href=`/mis-propiedades?pagina=${n}` class=`${paginaActual == n ? 'bg-indigo-50 border-indigo-50 text-indigo-600' : 'bg-white border-gray-300 text-gray-500 hover:bg-gray-100'} relative inline-flex items-center px-4 py-2 border text-sm font-medium`) #{n++}

        else
            p(class="text-yellow-200 font-bold text-center") No hay propiedades




            

block scripts
    script(src="/js/cambiarEstado.js") 

    block pie 
    div 
        h2(class="text-center text-sm text-gray-400 py-2") &copy; TODOS LOS DERECHOS RESERVADOS #{new Date().getFullYear()} | Ubiko &hearts;